<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>馒头馅儿大肉包</title>
  
  
  <link href="https://mantouxianer.github.io/mantouxianer/atom.xml" rel="self"/>
  
  <link href="https://mantouxianer.github.io/mantouxianer/"/>
  <updated>2022-12-28T10:01:37.712Z</updated>
  <id>https://mantouxianer.github.io/mantouxianer/</id>
  
  <author>
    <name>馒头馅儿大肉包</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Shell脚本基础</title>
    <link href="https://mantouxianer.github.io/mantouxianer/2022/12/28/Shell%E8%84%9A%E6%9C%AC%E5%9F%BA%E7%A1%80/"/>
    <id>https://mantouxianer.github.io/mantouxianer/2022/12/28/Shell%E8%84%9A%E6%9C%AC%E5%9F%BA%E7%A1%80/</id>
    <published>2022-12-28T09:43:29.000Z</published>
    <updated>2022-12-28T10:01:37.712Z</updated>
    
    <content type="html"><![CDATA[<h2 id="shell脚本创建过程"><a href="#shell脚本创建过程" class="headerlink" title="shell脚本创建过程"></a>shell脚本创建过程</h2><ul><li><p>第一行必须包括shell声明序列 #!</p><p>  #!&#x2F;bin&#x2F;bash</p></li></ul><p>范例:打印hello world</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@ubuntu2004 ~]<span class="comment">#cat /usr/local/bin/hello.sh</span></span><br><span class="line"><span class="comment">#!bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;hello world&#x27;</span></span><br></pre></td></tr></table></figure><ul><li><p>增加执行权限:chmod +x命令</p><h2 id="Shell脚本开发的基本规范及习惯"><a href="#Shell脚本开发的基本规范及习惯" class="headerlink" title="Shell脚本开发的基本规范及习惯"></a>Shell脚本开发的基本规范及习惯</h2></li><li><p>Shell脚本的第一行是指定脚本解释器<code>#!/bin/bash</code></p></li><li><p>Shell脚本的开头会加版本、版权等信息,可修改“～&#x2F;.vimrc”配置文件配置vim编辑文件时自动添加</p></li><li><p>在Shell脚本中尽量不用中文（不限于注释）。尽量用英文注释，防止本机或切换系统环境后中文乱码的困扰。如果非要加中文，请根据自身的客户端对系统进行字符集调整，如：export LANG&#x3D;”zh_CN.UTF-8”，并在脚本中，重新定义字符集设置，和系统保持一致</p></li><li><p>Shell脚本应存放在固定的路径下。&#x2F;usr&#x2F; local&#x2F;scr</p></li><li><p>成对的符号应尽量一次性写出来，然后退格在符号里增加内容，以防止遗漏</p></li><li><p>中括号（[]）两端至少要有1个空格，因此，键入中括号时即可留出空格[ ]，然后再退格键入中间的内容，并确保两端都至少有一个空格，即先键入一对中括号，然后退1格，输入两个空格，再退1格，双中括号（[[]]）的写法也是如此。</p></li><li><p>对于流程控制语句，应一次性将格式写完，再添加内容</p></li><li><p>对于常规变量的字符串定义变量值应加双引号，并且等号前后不能有空格，需要强引用的（指所见即所得的字符引用），则用单引号（’ ‘），如果是命令的引用，则用反引号（<code> </code>）</p><h3 id="运行脚本的方法"><a href="#运行脚本的方法" class="headerlink" title="运行脚本的方法:"></a>运行脚本的方法:</h3></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#方法一:bash加路径</span></span><br><span class="line">[root@ubuntu2004 /usr/local]<span class="comment">#bash /data/hello.sh</span></span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line"><span class="comment">#方法二:在PATH变量定义过的路径下创建文件</span></span><br><span class="line">[root@ubuntu2004 /usr/local/bin]<span class="comment">#bash hello.sh</span></span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line">方法三:用.或者<span class="built_in">source</span>加载脚本</span><br><span class="line">[11:10:40 root@centos7[ ~]<span class="comment">#. test.sh </span></span><br><span class="line">hello world</span><br><span class="line">hello world </span><br></pre></td></tr></table></figure><h2 id="shell脚本调试"><a href="#shell脚本调试" class="headerlink" title="shell脚本调试"></a>shell脚本调试</h2><p>脚本错误:</p><ul><li>语法错误,脚本中后续的命令不再继续执行,bash -n检查</li><li>命令错误,后续的命令会继续执行,用bash -x检查</li><li>逻辑错误,用bash -x检查</li></ul><h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p>类型</p><ul><li><p>内置环境变量</p></li><li><p>用户自定义变量</p><h3 id="shell中变量命令法则"><a href="#shell中变量命令法则" class="headerlink" title="shell中变量命令法则"></a>shell中变量命令法则</h3></li><li><p>不能使用程序中 的保留字和内置变量</p></li><li><p>只能使用数字,字母,及 下划线且不能以数字开头,不能使用短横线-</p></li><li><p>变量名要大写</p><h3 id="变量定义和引用"><a href="#变量定义和引用" class="headerlink" title="变量定义和引用"></a>变量定义和引用</h3></li><li><p>普通变量:生效范围为当前shell,对当前shell之外的包括子shell进程无效</p></li><li><p>环境变量:生效范围为当前shell及子进程,所有用户下都生效</p></li><li><p>本地变量:当前shell进程中代码片段,函数.</p></li></ul><p>定义:</p><pre><code>直接字串  NAME=&#39;root&#39;变量引用  NAME=&quot;$USER&quot;命令引用  NAME=`cmd`或者name=$(cmd)</code></pre><p>变量引用:</p><pre><code>$name$(name)</code></pre><p>变量追加值:</p><pre><code>[root@ubuntu2004 ~]#wo+=:wang[root@ubuntu2004 ~]#echo $wocto:wang</code></pre><p>显示已定义的所有变量: <code>set</code>删除变量: <code>unset &lt;name&gt;</code></p><h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量:"></a>环境变量:</h3><p>脚本中较少使用,声明和赋值:</p><pre><code>export  NAME=VALUE</code></pre><p>显示所有环境变量</p><pre><code>envexport</code></pre><p>环境变量永久生效,写入文件</p><pre><code>/etc/profile   ~/.bash_profile~/.bashrc/etc/bashrc</code></pre><h3 id="只读变量-常量"><a href="#只读变量-常量" class="headerlink" title="只读变量(常量)"></a>只读变量(常量)</h3><p>声明:</p><pre><code>readonly  变量名</code></pre><p>查看:</p><pre><code>readonly  [-p]</code></pre><h3 id="常规普通变量定义总结："><a href="#常规普通变量定义总结：" class="headerlink" title="常规普通变量定义总结："></a>常规普通变量定义总结：</h3><ul><li>若变量内容为连续的数字或字符串，赋值时，变量内容两边可以不加引号，例如a&#x3D;123。</li><li>变量的内容很多时，如果有空格且希望解析内容中的变量，就加双引号，例如a&#x3D;”&#x2F;etc&#x2F;rc.local $USER” ，此时输出变量会对内容中的$USER进行解析然后再输出。</li><li>希望原样输出变量中的内容时就用单引号引起内容进行赋值，例如：a&#x3D;’$USER’。</li><li>希望变量的内容是命令的解析结果的定义及赋值如下：要使用反引号将赋值的命令括起来，例如：a&#x3D;<code>ls</code>；或者用$()括起来，例如：a&#x3D;$(ls)。</li></ul><p>范例:</p><pre><code>[11:42:19 root@centos7[ ~]#echo &#39;today is date&#39;today is date#单引号里的内容,看到是什么就输出什么,即使有反引号也没用[12:48:31 root@centos7[ ~]#echo &#39;today is `date`&#39;today is `date`#用双引号引起来,里面是变量或者被反向单引号引起来的命令时,会先将变量或者命令解析成具体内容[12:48:39 root@centos7[ ~]#echo &quot;today is `date`&quot;today is Tue Dec 22 12:51:11 CST 2020</code></pre><h3 id="变量定义的技巧及注意事项："><a href="#变量定义的技巧及注意事项：" class="headerlink" title="变量定义的技巧及注意事项："></a>变量定义的技巧及注意事项：</h3><ul><li><p>注意命令变量内容前后的字符&#96;&#96;（此字符为键盘Tab键上面的那个反引号，不是单引号），例如：“CMD&#x3D;<code>ls</code>”。</p></li><li><p>在变量名前加$可以取得该变量的值，使用echo或printf命令可以显示变量的值，$A和${A}的写法不同，但效果是一样的。</p></li><li><p>用echo等命令输出变量的时候，也可用单引号、双引号、反引号，例如：echo$A、echo “$A”、echo ‘$A’，它们的用法和前面变量内容定义的总结是一致的。</p></li><li><p>$dbname_tname，当变量后面连接有其他字符的时候，必须给变量加上大括号{}，例如：$dbname_tname就要改成${dbname}_tname。</p><h4 id="查看shell版本"><a href="#查看shell版本" class="headerlink" title="查看shell版本"></a>查看shell版本</h4><pre><code>#ubuntu的默认shell版本为5.0root@ubuntu2004:~# bash --versionGNU bash, version 5.0.17(1)-release (x86_64-pc-linux-gnu)Copyright (C) 2019 Free Software Foundation, Inc.License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</code></pre></li></ul><p>This is free software; you are free to change and redistribute it.There is NO WARRANTY, to the extent permitted by law.</p><h2 id="位置变量"><a href="#位置变量" class="headerlink" title="位置变量:"></a>位置变量:</h2><p>位置变量的用法:</p><ul><li><p>切换到PATH环境变量路径</p><ul><li><p>用vim编辑文件,</p><ul><li><p>$1,$2一直到$n为位置变量,从$10开始要用{} 括起来如:${10}</p><ul><li><p>$*为全部参数合成一个字符串 ,即一个整体</p><ul><li>$@  将每个参数视为独立字符串,这是将多参数传递给其他程序的最佳方式</li><li>$#传递给脚本的参数的个数</li><li>$0 脚本名称,包括路径</li></ul><p>注意:$@和$*只有在被双引号抱起来的时候才会有差异<br>如果一个参数超过两个字符,要加{}</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br></pre></td><td class="code"><pre><span class="line">        [root@ubuntu2004 ~]<span class="comment">#cd /usr/local/bin/  </span></span><br><span class="line">        [root@ubuntu2004 /usr/local/bin]<span class="comment">#vim arg.sh  </span></span><br><span class="line">        [root@ubuntu2004 /usr/local/bin]<span class="comment">#cat arg.sh </span></span><br><span class="line">        <span class="comment">#!/bin/bash</span></span><br><span class="line">        <span class="built_in">echo</span> 1st arg is <span class="variable">$1</span>     </span><br><span class="line">        <span class="built_in">echo</span> 2st arg is <span class="variable">$2</span>     </span><br><span class="line">        <span class="built_in">echo</span> 3st arg is <span class="variable">$3</span></span><br><span class="line">        <span class="built_in">echo</span> 10st arg is <span class="variable">$&#123;10&#125;</span></span><br><span class="line">        <span class="built_in">echo</span> All args are $*      </span><br><span class="line">        <span class="built_in">echo</span> All args are <span class="variable">$@</span>     </span><br><span class="line">        <span class="built_in">echo</span> The arg number is <span class="variable">$#</span>    </span><br><span class="line">        <span class="built_in">echo</span> The scriptname is $(<span class="built_in">basename</span> <span class="variable">$0</span>) <span class="comment">#只要文件名命令为basename,前面的$为引用变量</span></span><br><span class="line">        <span class="comment">#给脚本赋值参数,自动把脚本后面跟的参数赋值 $1,$2...$n,没有参数则不输出</span></span><br><span class="line">        [root@ubuntu2004 /usr/local/bin]<span class="comment">#bash arg.sh 1 2 3  </span></span><br><span class="line">        1st arg is 1                                         </span><br><span class="line">        2st arg is 2                                        </span><br><span class="line">        3st arg is 3</span><br><span class="line">        10st arg is</span><br><span class="line">        All args are 1 2 3</span><br><span class="line">        All args are 1 2 3</span><br><span class="line">        The arg number is 3</span><br><span class="line">        The scriptname is arg.sh</span><br><span class="line">        [root@ubuntu2004 /usr/local/bin]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">范例:<span class="variable">$0</span>,<span class="variable">$#</span>,<span class="variable">$n</span>和多个参数</span><br><span class="line"></span><br><span class="line">    [08:57:39 root@centosmini[ ~]<span class="comment">#cat e.sh</span></span><br><span class="line">    <span class="comment">#!/bin/bash</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$0</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$1</span> <span class="variable">$2</span> <span class="variable">$3</span> <span class="variable">$4</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$#</span></span><br><span class="line">    <span class="built_in">echo</span> $*</span><br><span class="line">    <span class="comment">#给脚本从a到z 26个参数,$#说明传入了26个参数</span></span><br><span class="line">    [08:56:39 root@centosmini[ ~]<span class="comment">#sh e.sh &#123;a..z&#125;</span></span><br><span class="line">    e.sh</span><br><span class="line">    a b c d</span><br><span class="line">    26</span><br><span class="line">    a b c d e f g h i j k l m n o p q r s t u v w x y z</span><br><span class="line">    <span class="comment">#多个参数</span></span><br><span class="line">    [09:26:30 root@centosmini[ ~]<span class="comment">#vim test.sh</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$1</span> <span class="variable">$2</span> <span class="variable">$3</span> <span class="variable">$4</span> <span class="variable">$5</span> <span class="variable">$6</span> <span class="variable">$7</span> <span class="variable">$8</span> <span class="variable">$9</span> <span class="variable">$10</span> <span class="variable">$11</span> <span class="variable">$12</span> <span class="variable">$13</span> <span class="variable">$14</span> <span class="variable">$15</span>  </span><br><span class="line">    <span class="comment">#$10之后的未加&#123;&#125;,输出内容不对了</span></span><br><span class="line">    [09:26:12 root@centosmini[ ~]<span class="comment">#sh test.sh &#123;a..z&#125;</span></span><br><span class="line">    a b c d e f g h i a0 a1 a2 a3 a4 a5</span><br><span class="line"></span><br><span class="line"><span class="comment">### $0特殊变量的作用</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$0</span>的作用为取出执行脚本的名称（包括路径）</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 范例：获取脚本的名称及路径</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#若不带路径执行脚本，那么输出结果就是脚本的名字</span></span><br><span class="line">    [09:41:24 root@centosmini[ ~]<span class="comment">#vim test.sh</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$0</span></span><br><span class="line">    <span class="comment">#若使用全路径执行脚本，那么输出结果就是全路径加上脚本的名字</span></span><br><span class="line">    [09:42:07 root@centosmini[ ~]<span class="comment">#sh /root/test.sh </span></span><br><span class="line">    /root/test.sh</span><br><span class="line">    <span class="comment">#当要执行的脚本为全路径时，$0也会带着路径。此时如果希望单独获取名称或路径，可以用dirname和basename命令</span></span><br><span class="line">    [09:44:41 root@centosmini[ ~]<span class="comment">#dirname /root/test.sh </span></span><br><span class="line">    /root</span><br><span class="line">    [09:44:57 root@centosmini[ ~]<span class="comment">#basename /root/test.sh </span></span><br><span class="line">    test.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 范例:利用$0和dirname,basename分别取出脚本名称和脚本路径</span></span><br><span class="line"></span><br><span class="line">    [09:50:03 root@centosmini[ ~]<span class="comment">#cat test.sh </span></span><br><span class="line">    <span class="built_in">basename</span> <span class="variable">$0</span></span><br><span class="line">    <span class="built_in">dirname</span>  <span class="variable">$0</span></span><br><span class="line">    [09:49:59 root@centosmini[ ~]<span class="comment">#sh /root/test.sh </span></span><br><span class="line">    test.sh</span><br><span class="line">    /root</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 范例:根据用户在命令行的传参个数判断用户的输入，不合要求的给予提示并退出。</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#方法一:如果参数个数不等于2个,则给与提示并退出返回值1,</span></span><br><span class="line">    [09:59:30 root@centosmini[ ~]<span class="comment">#vim test.sh</span></span><br><span class="line">    [ <span class="variable">$#</span> != 2 ] &amp;&amp; &#123;</span><br><span class="line">                  <span class="built_in">echo</span> <span class="string">&quot;请输入两个数&quot;</span></span><br><span class="line">                  <span class="built_in">exit</span> 1</span><br><span class="line">                  &#125;</span><br><span class="line">           <span class="built_in">echo</span> <span class="string">&quot;welcome biejing&quot;</span>   </span><br><span class="line">    <span class="comment">#给两个参数则输出后面的字符</span></span><br><span class="line">    [09:59:10 root@centosmini[ ~]<span class="comment">#sh test.sh wo de</span></span><br><span class="line">    welcome biejing</span><br><span class="line">    <span class="comment">#方法二:用if判断输入的参数不等于2个时,提示脚本路径及名称和参数个数,并退出</span></span><br><span class="line">    [10:09:10 root@centosmini[ ~]<span class="comment">#vim test.sh</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$#</span> != 2 ]                                                                                                                   </span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;usage:/root/ <span class="variable">$0</span> ager1 ager2&quot;</span></span><br><span class="line">       <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$1</span> <span class="variable">$2</span></span><br><span class="line">    [10:09:00 root@centosmini[ ~]<span class="comment">#sh test.sh wo de</span></span><br><span class="line">    wo de</span><br><span class="line">    [10:09:01 root@centosmini[ ~]<span class="comment">#sh test.sh </span></span><br><span class="line">    usage:/root/ test.sh ager1 ager2</span><br><span class="line"></span><br><span class="line"><span class="comment">### $?特殊位置变量</span></span><br><span class="line"></span><br><span class="line">获取执行上一个指令的返回值(0为成功,其他值为失败)不同命令的执行结果中，“$? ”的返回值不尽相同，但在工作场景中，常用的就是0和非0两种状态，0表示成功运行，非0表示运行失败。</span><br><span class="line"></span><br><span class="line">    <span class="comment">#echo查看返回值</span></span><br><span class="line">    [10:17:07 root@centosmini[ ~]<span class="comment">#name=&quot;I am lower&quot;</span></span><br><span class="line">    [10:27:44 root@centosmini[ ~]<span class="comment">#echo $name</span></span><br><span class="line">    I am lower</span><br><span class="line">    [10:27:51 root@centosmini[ ~]<span class="comment">#echo $?</span></span><br><span class="line">    0</span><br><span class="line"></span><br><span class="line">在企业场景下，“$? ”返回值的用法如下：1）判断命令、脚本或函数等程序是否执行成功。2）若在脚本中调用执行“<span class="built_in">exit</span> 数字”，则会返回这个数字给“$? ”变量。3）如果是在函数里，则通过“<span class="built_in">return</span> 数字”把这个数字以函数返回值的形式传给“$? ”。</span><br><span class="line"></span><br><span class="line"><span class="comment">### $$特殊变量(不常用)</span></span><br><span class="line"></span><br><span class="line">获取脚本执行的进程号（PID)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Shell变量子串</span></span><br><span class="line"></span><br><span class="line">第二个比较常用</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 范例:返回变量值的长度*</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#定义变量,打印变量内容</span></span><br><span class="line">    [10:17:07 root@centosmini[ ~]<span class="comment">#name=&quot;I am lower&quot;</span></span><br><span class="line">    [10:27:44 root@centosmini[ ~]<span class="comment">#echo $name</span></span><br><span class="line">    I am lower</span><br><span class="line">    <span class="comment">#打印变量的长度</span></span><br><span class="line">    [10:48:46 root@centosmini[ ~]<span class="comment">#echo $&#123;#name&#125;</span></span><br><span class="line">    10</span><br><span class="line"></span><br><span class="line">范例：截取lower变量的内容，从第2个字符之后开始截取，默认截取后面字符的全部，第2个字符不包含在内，也可理解为删除前面的多个字符。</span><br><span class="line"></span><br><span class="line">    <span class="comment">#定义变量</span></span><br><span class="line">    [11:22:42 root@centosmini[ ~]<span class="comment">#name=&quot;I am lower&quot;</span></span><br><span class="line">    [11:32:31 root@centosmini[ ~]<span class="comment">#echo $&#123;name&#125;</span></span><br><span class="line">    I am lower</span><br><span class="line">    <span class="comment">#相当于从I后面的空格开始计算,取到结尾</span></span><br><span class="line">    [11:32:51 root@centosmini[ ~]<span class="comment">#echo $&#123;name:2&#125;</span></span><br><span class="line">    am lower</span><br><span class="line"></span><br><span class="line"><span class="comment">#### </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#### 有关匹配删除的小结：</span></span><br><span class="line"></span><br><span class="line">□<span class="comment">#表示从开头删除匹配最短。□##表示从开头删除匹配最长。□%表示从结尾删除匹配最短。□%%表示从结尾删除匹配最长。□a*c表示匹配的字符串，*表示匹配所有，a*c匹配开头为a、中间为任意多个字符、结尾为c的字符串。□a*C表示匹配的字符串，*表示匹配所有，a*C匹配开头为a、中间为任意多个字符、结尾为C的字符串。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Shell特殊扩展变量</span></span><br><span class="line"></span><br><span class="line">每个表达式内的冒号都是可选的。如果省略了表达式中的冒号，则将每个定义中的“为空或未赋值”部分改为“未赋值”，也就是说，运算符仅用于测试变量是否未赋值。`<span class="variable">$&#123;parameter:-word&#125;</span>`的作用是如果parameter变量值为空或未赋值，则会返回word字符串替代变量的值。脚本中要用<span class="built_in">rm</span>命令删除变量定义的目录或者文件时如果变量为空可能会误删,这时指定一个值为空时的默认值如:`<span class="built_in">rm</span> -rf <span class="variable">$&#123;TEST:-/tmp/&#125;</span>`在企业中，针对目录路径等的处理就可以采用上述变量不存在（即赋指定值）的方式，防止因目录路径不存在而导致的异常。例如：变量如果为NULL或没有定义，则赋予一个备用的值，特别是针对变量的删除操作，这种方式会很有用，否则所删除的变量如果不存在，则可能导致未知的危险。</span><br><span class="line"></span><br><span class="line"><span class="comment">### 备份数据:</span></span><br><span class="line"></span><br><span class="line">实现运行脚本备份文件夹</span><br><span class="line"></span><br><span class="line">    <span class="comment">#vim编辑文件</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#vim /usr/local/bin/backup.sh</span></span><br><span class="line">    <span class="comment">#SRC变量为脚本执行要跟的参数也就是要备份的文件夹为$1,DEST为备份以后的文件</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#cat  /usr/local/bin/backup.sh </span></span><br><span class="line">    <span class="comment">#!/bin/bash</span></span><br><span class="line">    SRC=<span class="variable">$1</span></span><br><span class="line">    DEST=/backup<span class="variable">$&#123;SRC&#125;</span>_`<span class="built_in">date</span> +%F_%H-%M-%S`   <span class="comment">#为避免将SRC_视为整体一个不存在的</span></span><br><span class="line">                                               变量,要加&#123;&#125;将变量括起来,确保识别</span><br><span class="line">    <span class="built_in">cp</span> -av <span class="variable">$SRC</span> <span class="variable">$DEST</span>    <span class="comment">#选项-av为保留文件属性显示过程          定义过的SRC变量</span></span><br><span class="line">    <span class="comment">#增加x权限,执行脚本备份/etc目录,/etc不要加/</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#chmod +x /usr/local/bin/backup.sh </span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#bash backup.sh /etc</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 删库跑路之命令rm的安全实现(垃圾箱)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#用vim编辑文本,注意不要有多余的空格,$*为要删除的所有文件,变量WARNING_COLOR定义了颜色,这里是红色,END为颜色结束符</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#vim /usr/local/bin/rm.sh </span></span><br><span class="line">    <span class="comment">#!/bin/bash</span></span><br><span class="line">     WARNING_COLOR=<span class="string">&quot;echo -e \E[1;31m&quot;</span></span><br><span class="line">     END=<span class="string">&quot;\E[0m&quot;</span></span><br><span class="line">     DIR=/tmp/`<span class="built_in">date</span> +%F_%H-%M-%S`</span><br><span class="line">     <span class="built_in">mkdir</span> <span class="variable">$DIR</span></span><br><span class="line">     <span class="built_in">mv</span> $* <span class="variable">$DIR</span></span><br><span class="line">     <span class="variable">$&#123;WARNING_COLOR&#125;</span>Move $* to <span class="variable">$DIR</span> <span class="variable">$END</span></span><br><span class="line">    <span class="comment">#创建要删除的文件</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#touch &#123;a..z&#125;.txt</span></span><br><span class="line">    <span class="comment">#增加x权限</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#chmod a+x /usr/local/bin/rm.sh</span></span><br><span class="line">    <span class="comment">#运行rm命令删除文件,显示所有的文件都被移动到/tmp/下并以时间命令的文件夹中</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#rm *.txt</span></span><br><span class="line">    Move a.txt b.txt c.txt d.txt e.txt f.txt g.txt h.txt i.txt j.txt k.txt l.txt m.txt n.txt o.txt p.txt q.txt r.txt s.txt t.txt u.txt v.txt w.txt x.txt y.txt z.txt to /tmp/2020-12-12_00-38-16</span><br><span class="line"></span><br><span class="line"><span class="comment">### 利用软链接实现同一个脚本不同的功能</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#创建文件,显示脚本名字</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#vim test.sh</span></span><br><span class="line">    <span class="comment">#!/bin/bash</span></span><br><span class="line">    <span class="built_in">echo</span> The scriptname is `<span class="built_in">basename</span> <span class="variable">$0</span>`</span><br><span class="line">    <span class="comment">#运行脚本,此时的结果是test.sh本身</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#bash test.sh</span></span><br><span class="line">    The scriptname is test.sh</span><br><span class="line">    <span class="comment">#给test.sh创建一个a.sh的软链接</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#ln -s test.sh a.sh</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#ll a.sh</span></span><br><span class="line">    lrwxrwxrwx 1 root root 7 Dec 12 01:01 a.sh -&gt; test.sh</span><br><span class="line">    <span class="comment">#这时运行a.sh的结果是a.sh</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#bash a.sh</span></span><br><span class="line">    The scriptname is a.sh</span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#bash b.sh</span></span><br><span class="line">    The scriptname is b.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">## 退出状态码</span></span><br><span class="line"></span><br><span class="line">进程执行后,将使用变量￼$?保存状态码,$?为系统自带变量</span><br><span class="line"></span><br><span class="line">* $?值为0时,代表成功</span><br><span class="line"></span><br><span class="line">* $?值为1到255,代表失败</span><br><span class="line">  </span><br><span class="line">      <span class="comment"># $?显示的是前一条命令的执行结果,如果没有出错结果就是0</span></span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#echo $?</span></span><br><span class="line">      0</span><br><span class="line">      <span class="comment">#执行一个失败的命令,将返回一个非0数</span></span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#ll /xxx/</span></span><br><span class="line">      <span class="built_in">ls</span>: cannot access <span class="string">&#x27;/xxx/&#x27;</span>: No such file or directory</span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#echo $?</span></span><br><span class="line">      2</span><br><span class="line"></span><br><span class="line">用户可以在脚本中使用命令自定义退出状态码</span><br><span class="line"></span><br><span class="line">    <span class="built_in">exit</span> [n]</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 脚本里的exit退出状态码</span></span><br><span class="line"></span><br><span class="line">* 脚本中一旦遇到<span class="built_in">exit</span>命令,会立即终止,终止退出状态码取决于<span class="built_in">exit</span>后面跟的数字</span><br><span class="line"></span><br><span class="line">* 如果<span class="built_in">exit</span>后面无数字,终止退出状态取决于<span class="built_in">exit</span>命令前面命令执行结果</span><br><span class="line"></span><br><span class="line">* 如果没有<span class="built_in">exit</span>命令,即没给脚本指定退出状态码,整个脚本的退出状态码取决于脚本中最后一条命令的状态码</span><br><span class="line">  </span><br><span class="line">      <span class="comment">#exit后面不指定数字,将使用系统自定义的状态码,exit只记录前面一条命令的执行结果,也就是exit的返回值和前一条命令有关,遇到exit脚本将直接退出,后面的命令不再执行</span></span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#vim test.sh</span></span><br><span class="line">      <span class="comment">#!/bin/bash</span></span><br><span class="line">      <span class="built_in">echo</span> The scriptname is `<span class="built_in">basename</span> <span class="variable">$0</span>`</span><br><span class="line">      <span class="built_in">exit</span></span><br><span class="line">      <span class="built_in">echo</span> script is finished</span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#bash test.sh</span></span><br><span class="line">      The scriptname is test.sh</span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#echo $?</span></span><br><span class="line">      0</span><br><span class="line">      <span class="comment">#要指定exit的返回值直接指定就可以</span></span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#vim test.sh</span></span><br><span class="line">      <span class="comment">#!/bin/bash</span></span><br><span class="line">      <span class="built_in">echo</span> The scriptname is `<span class="built_in">basename</span> <span class="variable">$0</span>`</span><br><span class="line">      <span class="built_in">exit</span> 100</span><br><span class="line">      <span class="built_in">echo</span> script is finished</span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#bash test.sh</span></span><br><span class="line">      The scriptname is test.sh</span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#echo $?</span></span><br><span class="line">      100</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 查看命令是否执行成功</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#grep搜索文件中的root字符,</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#grep root /etc/passwd</span></span><br><span class="line">    root:x:0:0:root:/root:/bin/bash</span><br><span class="line">    <span class="comment">#grep -q为不显示执行结果,可以用echo -$?查看状态码,当为0时表示执行成功,不为0时则为失败</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#grep -q root /etc/passwd</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#echo $?</span></span><br><span class="line">    0</span><br><span class="line">    <span class="comment">#查看ping命令是否执行成功,将结果丢到垃圾箱/dev/null中,利用状态码判断是否ping通,</span></span><br><span class="line">    -c1为ping的次数为一次,&amp;&gt;表示不管错误还是正确结果都丢/dev/null中,<span class="built_in">echo</span> $?显示状态码为0,执行成功,ip地址是通的</span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#ping -c1 10.0.0.115 &amp;&gt; /dev/null</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#echo $?</span></span><br><span class="line">    0</span><br><span class="line">    <span class="comment">#ping一个无法连接的ip,-W1表示ping的等待延时,超过1s钟就返回结果</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#ping -c1 -W1 10.0.0.110 &amp;&gt; /dev/null</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#echo $?</span></span><br><span class="line">    1</span><br><span class="line"></span><br><span class="line"><span class="comment">## 脚本安全和set</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>命令可以定制shell环境,<span class="built_in">set</span>是一个内部命令</span><br><span class="line"></span><br><span class="line">    <span class="comment">#定义dir变量,rm命令引用时如果变量名写错,引用的变量将为空,将执行的命令变为rm -fr /*</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#dir=/data</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#rm -fr $dlr/*</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#### 查看和改变$-变量</span></span><br><span class="line"></span><br><span class="line">* h:打开后shell会把命令的路径<span class="built_in">hash</span>下来,</span><br><span class="line"></span><br><span class="line">* i:说明当前的shell是一个交互式的shell,在脚本中i是关闭的</span><br><span class="line"></span><br><span class="line">* m:打开监控模式,就可以通过Job control 来控制进程的停止,继续,后台或者前台执行等</span><br><span class="line"></span><br><span class="line">* B:打开&#123;&#125;扩展</span><br><span class="line"></span><br><span class="line">* H:<span class="built_in">history</span>,打开可以展开历史列表中的命令</span><br><span class="line">  </span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#echo $-</span></span><br><span class="line">      himBHs</span><br><span class="line">      <span class="comment"># 关闭&#123;&#125;扩展功能,其他也可以用set +字母的方式关闭</span></span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#set +B</span></span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#echo $-</span></span><br><span class="line">      himHs</span><br><span class="line">      <span class="comment"># 打开set -字母</span></span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#set -B</span></span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#echo $-</span></span><br><span class="line">      himBHs</span><br><span class="line"></span><br><span class="line"><span class="comment">#### set命令实现脚本安全</span></span><br><span class="line"></span><br><span class="line">* -u 在扩展一个没有设置的变量时,显示错误信息</span><br><span class="line"></span><br><span class="line">* -e 如果一个命令返回一个非0退出状态(失败)就退出,不再继续执行后面的命令.脚本的语法错误遇到会停止执行,但命令错误不会阻止后面的命令继续执行.</span><br><span class="line">  </span><br><span class="line">      <span class="comment">#脚本前面加set -u打开变量检查,rm命令引用了一个错误的变量,如果变量不存在将报错不会执行</span></span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#vim set.sh</span></span><br><span class="line">      <span class="comment">#!/bin/bash</span></span><br><span class="line">      <span class="built_in">set</span> -u</span><br><span class="line">      DIR=/data</span><br><span class="line">      <span class="built_in">rm</span> rf <span class="variable">$DIlR</span>/*</span><br><span class="line">      <span class="built_in">echo</span> <span class="variable">$DIR</span> is clean</span><br><span class="line">      [root@ubuntu2004 /usr/local/bin]<span class="comment">#bash set.sh</span></span><br><span class="line">      set.sh: line 4: DIlR: unbound variable</span><br><span class="line"></span><br><span class="line">这两个选项很有用,建议所有脚本都加上</span><br><span class="line"></span><br><span class="line">    <span class="comment">#每个脚本开头加上这两句</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#vim set.sh</span></span><br><span class="line">    <span class="comment">#!/bin/bash</span></span><br><span class="line">    <span class="built_in">set</span> -ue</span><br><span class="line"></span><br><span class="line"><span class="comment">## 格式化输出printf</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># %s将后面的当成字符串,\n表示换行,后面跟的变量要加空格</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#printf &quot;%s\n&quot; 1 2 3 4</span></span><br><span class="line">    1</span><br><span class="line">    2</span><br><span class="line">    3</span><br><span class="line">    4</span><br><span class="line">    <span class="comment"># %f将后面的当成浮点格式</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#printf &quot;%f\n&quot; 1 2 3 4</span></span><br><span class="line">    1.000000</span><br><span class="line">    2.000000</span><br><span class="line">    3.000000</span><br><span class="line">    4.000000</span><br><span class="line">    <span class="comment"># %f可以约定保留的小数点,.2f表示保留两位小数</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#printf &quot;%.2f\n&quot; 1 2 3 4</span></span><br><span class="line">    1.00</span><br><span class="line">    2.00</span><br><span class="line">    3.00</span><br><span class="line">    4.00</span><br><span class="line">    <span class="comment"># (%s)给每个字符串加上(),可以换成&#123;&#125;等</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#printf &quot;(%s)&quot; 1 2 3 4;echo</span></span><br><span class="line">    (1)(2)(3)(4)</span><br><span class="line">    <span class="comment"># %s:将每个字符串用冒号连接</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#printf &quot;%s:&quot; 1 2 3 4</span></span><br><span class="line">    1:2:3:4:</span><br><span class="line">    <span class="comment"># %s %s\n 将后面的字符串两个一组显示并加上换行符</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#printf &quot;%s %s\n&quot; 1 2 3 4 </span></span><br><span class="line">    1 2</span><br><span class="line">    3 4</span><br><span class="line">    <span class="comment"># %s %s %s\n 表示三个一组</span></span><br><span class="line">    [root@ubuntu2004 /usr/local/bin]<span class="comment">#printf &quot;%s %s %s\n&quot; 1 2 3 4 5  6</span></span><br><span class="line">    1 2 3</span><br><span class="line">    4 5 6</span><br><span class="line">    <span class="comment"># 以四个一组,%#s中的数字代表此替换符中的输出字符宽度,不足补空格,默认右对齐;%-10s表示10个字符宽度,-表示左对齐</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#printf &quot;%-10s %-10s %-4s %s \n&quot; 姓名 性别 年龄 体重 小明 男 20 80 小红 女 18 110</span></span><br><span class="line">    姓名     性别     年龄 体重 </span><br><span class="line">    小明     男        20   80 </span><br><span class="line">    小红     女        18   110 </span><br><span class="line">    <span class="comment"># %x表示将十进制转换成16进制</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#printf &quot;%X&quot; 20</span></span><br><span class="line">    14</span><br><span class="line">    <span class="comment"># %d表示将16进制转换成10制,如16制C</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#printf &quot;%d\n&quot; 0xC</span></span><br><span class="line">    12</span><br><span class="line">    <span class="comment"># 先定义变量VAR然后输出带有颜色的字符,1;表示高亮32m表示绿色,\E0m表示颜色结束</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#VAR=&quot;welcome to beijng&quot;;printf &quot;\E[1;32m%s\E[0m\n&quot; $VAR</span></span><br><span class="line">    welcome</span><br><span class="line">    to</span><br><span class="line">    beijng</span><br><span class="line">    <span class="comment"># &quot;$VAR&quot;加上双引号将视为一个整体,不再换行</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#VAR=&quot;welcome to beijng&quot;;printf &quot;\E[1;32m%s\E[0m\n&quot; &quot;$VAR&quot;</span></span><br><span class="line">    welcome to beijng</span><br><span class="line"></span><br><span class="line"><span class="comment">## 算数运算</span></span><br><span class="line"></span><br><span class="line">注意:bash只支持整数,不支持小数算数运算符号:表中的算术运算符号均适用于常见的运算命令</span><br><span class="line"></span><br><span class="line"><span class="comment">### 实现算数运算</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 方法一:let 变量=算术表达式</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#a=10</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#b=20</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#let c=a+b</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#echo $c</span></span><br><span class="line">    30</span><br><span class="line">    <span class="comment"># 方法二:((变量=算术表达式))</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#((d=a+b))</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#echo $d</span></span><br><span class="line">    30</span><br><span class="line">    <span class="comment">#指数运算,两个*</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#((c=2**a))</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#echo $c</span></span><br><span class="line">    1024</span><br><span class="line">    <span class="comment">#方法三:$[算数表达式]</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#echo $[b/a]</span></span><br><span class="line">    2</span><br><span class="line">    <span class="comment">#方法四,利用bc计算器</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#echo &quot;$a+$b&quot;|bc</span></span><br><span class="line">    30</span><br><span class="line"></span><br><span class="line"><span class="comment">### 双小括号“(())”数值运算的基础语法</span></span><br><span class="line"></span><br><span class="line">双小括号“(())”的作用是进行数值运算与数值比较，它的效率很高，用法灵活，是企业场景运维人员经常采用的运算操作符</span><br><span class="line"></span><br><span class="line">    <span class="comment">#直接计算,注意不要忘了$符号</span></span><br><span class="line">    [13:24:51 root@centosmini[ ~]<span class="comment">#echo $((1+3**7-4%3))</span></span><br><span class="line">    2187</span><br><span class="line">    <span class="comment">#将变量在括号中定义并计算</span></span><br><span class="line">    [13:24:17 root@centosmini[ ~]<span class="comment">#((a=1+2*3))</span></span><br><span class="line">    [13:24:45 root@centosmini[ ~]<span class="comment">#echo $a</span></span><br><span class="line">    7</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 利用“(())”双括号进行比较及判断</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#3&lt;8的结果成立,因此输出1,表示真</span></span><br><span class="line">    [13:25:48 root@centosmini[ ~]<span class="comment">#echo $((3&lt;8))</span></span><br><span class="line">    1</span><br><span class="line"></span><br><span class="line">“(())”表达式在命令行执行时不需要加$符号，直接使用((<span class="number">6</span>%<span class="number">2</span>))形式即可，但是如果需要输出，就要加$符，例如：<span class="built_in">echo</span> $((<span class="number">6</span>%<span class="number">2</span>))。“(())”里的所有字符之间没有空格、有一个或多个空格都不会影响结果。</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 范例:各种“(())”运算的Shell脚本示例</span></span><br><span class="line"></span><br><span class="line">    [13:44:43 root@centosmini[ ~]<span class="comment">#vim test.sh</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#!bin/bash</span></span><br><span class="line">    a=5</span><br><span class="line">    b=4</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;a-b=<span class="subst">$(($a-$b)</span>)&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;a+b=<span class="subst">$(($a+$b)</span>)&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;a*b=<span class="subst">$(($a*$b)</span>)&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;a/b=<span class="subst">$(($a/$b)</span>)&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;a**b=<span class="subst">$(($a**$b)</span>)&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;a%b=<span class="subst">$(($a%$b)</span>)&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;a+b=<span class="subst">$((a+b)</span>)&quot;</span> </span><br><span class="line">    [13:44:37 root@centosmini[ ~]<span class="comment">#sh test.sh </span></span><br><span class="line">    a-b=1</span><br><span class="line">    a+b=9</span><br><span class="line">    a*b=20</span><br><span class="line">    a/b=1</span><br><span class="line">    a**b=625</span><br><span class="line">    a%b=1</span><br><span class="line">    a+b=9</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 利用RANDOM生成随机数字</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$RANDOM</span>是系统自带变量,每次执行都会生成随机数字</span><br><span class="line"></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#echo $RANDOM</span></span><br><span class="line">    4399</span><br><span class="line">    <span class="comment">#生成1到70之间的随机数字,两个括号为方法二的算数表示方法,RANDOM%70表示对生成的数字进行取余数,即取模,生成1到69之间随机数,+1表示1到70之间的数字</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#echo $((RANDOM%70+1))</span></span><br><span class="line">    25</span><br><span class="line">    <span class="comment"># 生成随机颜色的字符,$[]可以用(())代替,$&#123;COLOR&#125;表示让系统识别为一个变量这里不能用[]否则会让变量失效,-e表示让echo识别\转义字符</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#COLOR=$[RANDOM%7+31];echo -e &quot;\E[$&#123;COLOR&#125;;1mbeijing\E[0m&quot;</span></span><br><span class="line">    beijing</span><br><span class="line"></span><br><span class="line"><span class="comment">### </span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 增强型赋值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### let支持增强型赋值</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#  += i+=20 相当于i=i+20</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#i=10</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#let i+=20</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#echo $i</span></span><br><span class="line">    30</span><br><span class="line">    <span class="comment">#  -=   i-=j   相当于i=i-j</span></span><br><span class="line">    <span class="comment">#  *=   i*=j   相当于i=i*j</span></span><br><span class="line">    <span class="comment">#  /=   i/=j   相当于i=i/j</span></span><br><span class="line">    <span class="comment">#  ++   i++,++i  相当于i=i+1</span></span><br><span class="line">    <span class="comment">#  --   i--,--i  相当于i=i-1</span></span><br><span class="line"></span><br><span class="line">自增自减(++,--在前面和后面的区别)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#自增++,unset为删除i之前的赋值</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#unset i</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#i=10</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#let i++</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#echo $i</span></span><br><span class="line">    11</span><br><span class="line">    <span class="comment">#自减--</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#let i--</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#echo $i</span></span><br><span class="line">    10</span><br><span class="line">    <span class="comment">#  自加或自减在后面的时候,j=i++为先将i的值付给j,然后在自加,此时j=1,i++为2</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#i=1;let j=i++;echo i=$i j=$j</span></span><br><span class="line">    i=2 j=1</span><br><span class="line">    <span class="comment"># 自加或自减在前面的时候,j=++i为先做自加然后将值付给j,此时i和j的值都为2.</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#unset i j</span></span><br><span class="line">    [root@ubuntu2004 ~]<span class="comment">#i=1;let j=++i;echo i=$i j=$j</span></span><br><span class="line">    i=2 j=2</span><br><span class="line"></span><br><span class="line"><span class="comment">### expr命令用法</span></span><br><span class="line"></span><br><span class="line">* 用于计算,运算符及用于计算的数字左右都至少有一个空格，否则会报错</span><br><span class="line">  </span><br><span class="line">      [root@ubuntu2004 ~]<span class="comment">#expr 3 + 5</span></span><br><span class="line">      8</span><br><span class="line">      <span class="comment">#  *要做转义,不然如果目录下有文件时</span></span><br><span class="line">      [root@ubuntu2004 ~]<span class="comment">#expr 3 \* 5</span></span><br><span class="line">      15</span><br><span class="line"></span><br><span class="line">* 获取字符串长度 <span class="built_in">expr</span> length</span><br><span class="line">  </span><br><span class="line">      [14:57:47 root@centosmini[ ~]<span class="comment">#a=&quot;lower&quot;</span></span><br><span class="line">      [14:58:01 root@centosmini[ ~]<span class="comment">#expr length &quot;$a&quot;</span></span><br><span class="line">      5</span><br><span class="line">  </span><br><span class="line">  - 判断一个变量值或字符串是否为整数</span><br><span class="line">    </span><br><span class="line">    利用以<span class="built_in">expr</span>做计算时变量或字符串必须是整数的规则，把一个变量或字符串和一个已知的整数（非0）相加，看命令返回的值是否为0。如果为0，就认为做加法的变量或字符串为整数，否则就不是整数。</span><br><span class="line">    </span><br><span class="line">    ```bash</span><br><span class="line">    <span class="comment">#返回值为0,说明值为整数</span></span><br><span class="line">    [14:58:32 root@centosmini[ ~]<span class="comment">#a=5</span></span><br><span class="line">    [15:01:25 root@centosmini[ ~]<span class="comment">#expr $a + 4 &amp;&gt; /dev/null</span></span><br><span class="line">    [15:02:16 root@centosmini[ ~]<span class="comment">#echo $?</span></span><br><span class="line">    0</span><br><span class="line">    <span class="comment">#返回值不为0,证明不是整数</span></span><br><span class="line">    [15:03:25 root@centosmini[ ~]<span class="comment">#a=&quot;lower&quot;</span></span><br><span class="line">    [15:03:34 root@centosmini[ ~]<span class="comment">#expr $a + 5 &amp;&gt; /dev/null</span></span><br><span class="line">    [15:03:59 root@centosmini[ ~]<span class="comment">#echo $?</span></span><br><span class="line">    2</span><br><span class="line">    </span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ul></li></ul><p>通过传参判断输出内容是否为整数</p><pre><code>[15:14:15 root@centosmini[ ~]#vim expr.sh#!/bin/bashexpr $1 + 1 &amp;&gt;/dev/null                                                                                                            [ $? -eq 0 ] &amp;&amp; echo $1 是数字 || echo $1 是字符串#结果[15:15:25 root@centosmini[ ~]#sh expr.sh abcabc 是字符串[15:15:30 root@centosmini[ ~]#sh expr.sh 123123 是数字</code></pre><p>判断文件扩展名是否符合指定扩展名</p><pre><code>[15:25:18 root@centosmini[ ~]#vim expr2.sh#!/bin/bashif expr &quot;$1&quot; : &quot;.*\.avi$&quot; &gt;/dev/null ;then   echo &quot;好兴奋哦!&quot; else   echo &quot;好失望啊!&quot; fi           [15:24:40 root@centosmini[ ~]#sh expr2.sh so.avi好兴奋哦![15:25:08 root@centosmini[ ~]#sh expr2.sh so.log好失望啊!</code></pre><h4 id="鸡兔同笼"><a href="#鸡兔同笼" class="headerlink" title="鸡兔同笼"></a>鸡兔同笼</h4><p>今有鸡兔同笼，上有35头，下有94足，问鸡兔各多少只</p><pre><code># 定义头的数量为HEAD=$1,脚脚的数量为FOOT=$2要求输入的数字,兔子的数量为脚的数量减去两倍头的数量除以2[root@ubuntu2004 ~]#vim /usr/local/bin/chook_rabbit.sh#!bin/bashHEAD=$1FOOT=$2RABBIT=$[(FOOT-2*HEAD)/2]CHOOK=$[HEAD-RABBIT]echo &quot;兔子数量:$RABBIT&quot;echo &quot;鸡数量:$CHOOK&quot;# 脚的数量要比头大两倍以上[root@ubuntu2004 ~]#bash chook_rabbit.sh 35 94兔子数量:12鸡数量:23[root@ubuntu2004 ~]#bash chook_rabbit.sh 30 90兔子数量:15鸡数量:15</code></pre><h3 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h3><p>true,false</p><pre><code>1,真0,假#注意均为二进制</code></pre><p>与:&amp;:和0相与,结果为0,和1相与,结果保留原值</p><pre><code>0&amp;0   =00&amp;1   =01&amp;0   =01&amp;1   =1</code></pre><p>或:|:和1相或结果为1,和0相或,结果保留原值</p><pre><code>0|0   =00|1   =11|0   =11|1   =1</code></pre><p>非:!</p><pre><code>! 1 = 0! 0 = 1</code></pre><p>异或^两个值相同为假,不同为真.两个数字x,y异或得到结果z,z再和任意两个值之一异或如x,将得到y,z与y异或得到x</p><pre><code>1 ^ 1 = 01 ^ 0 = 10 ^ 1 = 10 ^ 0 = 0</code></pre><p>利用异或实现两个变量值的互换</p><pre><code># 第一步x等于x和y异或的第三个值,第二个x^y中y等于第三个值与y的异或就是原来的x,第三个x^y就相当于第三个值与x原本的值异或,实现两个值的互换[root@ubuntu2004 ~]#x=10;y=20;x=$[x^y];y=$[x^y];x=$[x^y];echo x=$x,y=$yx=20,y=10# 利用第三个变量实现互换[root@ubuntu2004 ~]#x=10;y=20;tmp=$x;x=$y;y=$tmp;echo x=$x,y=$yx=20,y=10</code></pre><h3 id="短路运算"><a href="#短路运算" class="headerlink" title="短路运算"></a>短路运算</h3><ul><li><p>短路与 &amp;&amp;</p><pre><code>cmd1 短路与 cmd2第一个cmd1结果为真,第二个cmd2必须执行,才能得到最终结果第一个cmd1结果为假,总的结果必定为0,因此不需要执行cmd2</code></pre></li><li><p>短路或 ||</p><pre><code>cmd1 短路或 cmd2第一个cmd1结果为真,总的结果必定为1,因此不需要执行cmd2第一个cmd1结果为假,第二个cmd2必须参与运算,才能得到最终结果</code></pre></li><li><p>cmd1 &amp;&amp; cmd2 || cmd3</p><pre><code>如果cmd1执行结果正确即为0,将执行cmd2;如果cmd1执行结果错误即为1时,就执行cmd3,cmd2和cmd3不会同时执行,不要&amp;&amp;和||互换位置.</code></pre></li></ul><h3 id="条件测试命令"><a href="#条件测试命令" class="headerlink" title="条件测试命令"></a>条件测试命令</h3><p>若真,状态码$?返回0若假,$?返回1条件测试命令:</p><pre><code>#方法一:test加判断表达式来比较两个字符串是否一样,不一样$?返回1,一样$?返回0[root@ubuntu2004 ~]#x=wang[root@ubuntu2004 ~]#y=lin[root@ubuntu2004 ~]#test $x = $y[root@ubuntu2004 ~]#echo $?1[root@ubuntu2004 ~]#y=wang[root@ubuntu2004 ~]#echo $?0#方法二:[  ]中间加判断表达式,注意前后都有空格,建议用[  ][root@ubuntu2004 ~]#[ $x = $y ][root@ubuntu2004 ~]#echo $?0#方法三:[[  ]]双中括号中间加判断表达式,相当于增强版[ ],支持表达式和通配符#[ ]加-z表示变量为空或没有值时返回真,不为空时返回假,变量尽量放在双引号中间[root@ubuntu2004 ~]#name=wang[root@ubuntu2004 ~]#[ -z &quot;$name&quot; ][root@ubuntu2004 ~]#echo $?1#[ ]加-n表示变量不为空也就是有值时为真;空或者没有值时为假,可以省略-n不加[root@ubuntu2004 ~]#unset name[root@ubuntu2004 ~]#[ -n &quot;$name&quot; ][root@ubuntu2004 ~]#echo $?1</code></pre><h3 id="变量测试"><a href="#变量测试" class="headerlink" title="变量测试*"></a>变量测试*</h3><pre><code>[ -v NAME ] 判断NAME是否定义*,定义过返回0,没定义返回1[ -R NAME ] 变量是否定义并且是名称引用</code></pre><p>范例:</p><pre><code># 由于没有定义变量name,所以返回的结果为1,表示没有定义[root@ubuntu2004 ~]#[ -v name ][root@ubuntu2004 ~]#echo $?1# name变量没有赋值,但已经被定义过了,所以返回0[root@ubuntu2004 ~]#name=&quot;&quot;[root@ubuntu2004 ~]#echo $?0</code></pre><h4 id="数字测试"><a href="#数字测试" class="headerlink" title="数字测试:"></a>数字测试:</h4><ul><li><p>-eq 是否等于</p></li><li><p>-ne 是否不等于</p></li><li><p>-gt 是否大于</p></li><li><p>-ge 是否大于等于</p></li><li><p>-lt 是否小于</p></li><li><p>-le 是否小于等于</p><pre><code># -gt表示如果i&gt;j则返回真,小于j则返回假1[root@ubuntu2004 ~]#i=10[root@ubuntu2004 ~]#j=20[root@ubuntu2004 ~]#[ $i -gt $j ][root@ubuntu2004 ~]#echo $?1#将i的值改为比j大,将返回真0[root@ubuntu2004 ~]#i=30[root@ubuntu2004 ~]#echo $?</code></pre></li></ul><p>0#利用短路与&amp;&amp;,如果i大于j就打印一条语句,如果i小于j就不会打印了[root@ubuntu2004 ~]#[ $i -gt $j ] &amp;&amp; echo “i大于j”i大于j</p><h1 id="利用短路或-将i的值改成10-比j小-i-gt-j-的比较结果为假-短路或-是如果左边的值为假时-才会执行右边的语句"><a href="#利用短路或-将i的值改成10-比j小-i-gt-j-的比较结果为假-短路或-是如果左边的值为假时-才会执行右边的语句" class="headerlink" title="利用短路或||,将i的值改成10,比j小,[ $i -gt $j ]的比较结果为假,短路或||是如果左边的值为假时,才会执行右边的语句"></a>利用短路或||,将i的值改成10,比j小,[ $i -gt $j ]的比较结果为假,短路或||是如果左边的值为假时,才会执行右边的语句</h1><p>[root@ubuntu2004 ~]#i&#x3D;10[root@ubuntu2004 ~]#[ $i -gt $j ] || echo “i小于j”i小于j</p><pre><code>算数表达式比较```bash==  相等!=  不相等&lt;=  小于等于&gt;=  大于等于&lt;   小于&gt;   大于</code></pre><p>范例:</p><pre><code>#判断x,y是否相等,==相等返回0,不相同返回1[root@ubuntu2004 ~]#x=10;y=10;(( x == y ));echo $?0#不同返回1[root@ubuntu2004 ~]#x=10;y=20;(( x == y ));echo $?1# 判断x,y是否不同,!=不同返回0,相同返回1[root@ubuntu2004 ~]#x=10;y=20;(( x != y ));echo $?0</code></pre><h4 id="监控磁盘空间"><a href="#监控磁盘空间" class="headerlink" title="监控磁盘空间:"></a>监控磁盘空间:</h4><p>当磁盘空间为一定的值时如80就报警,给管理员发邮件</p><pre><code>#df命令为显示磁盘占用率,grep &#39;^/dev/sd&#39;表示过滤掉除/dev/sd开头的行,也就是只显示以^后面字符开头的行;-E为使用扩展正则表达式,-o为只显示符合表达式的内容,也就是数字加%的字符,不然会匹配所有数字;sort -nr为从大到小排序,-n为从小到大排序,-r再反方向排序;head -1为只取第一个值,也就是最大值;&amp;&amp;为如果左边的数值大于等于80时,就给指定的邮箱发送报警邮件[root@ubuntu2004 ~]#vim /usr/local/bin/disk_check.sh#!bin/bashWARNING=80USE=`df |grep &#39;^/dev/sd&#39;|grep -Eo &#39;[0-9]+%&#39;|tr -d %|sort -nr|head -1`[ $USE -ge $WARNING ] &amp;&amp; echo Disk will be full | mail -s &quot;disk warning&quot; 1390463915@qq.com</code></pre><h4 id="检查主机是否宕机"><a href="#检查主机是否宕机" class="headerlink" title="检查主机是否宕机"></a>检查主机是否宕机</h4><p>编写脚本,确认主机是否连通,如果无结果将发送邮件报警</p><pre><code># -c1表示要ping的次数,这里ping一次就可以;-W1为无结果时的延时1秒,&amp;&gt;为不管有无结果都将结果丢到/dev/null中,&amp;&amp;和||表示如果前面的命令执行正确将执行&amp;&amp;后面的命令,如果执行错误将执行||后面的命令,实现条件判断.[root@ubuntu2004 ~]#vim /usr/local/bin/check_host.sh#!bin/bashIP=$1ping -c1 -W1 $IP &amp;&gt; /dev/null &amp;&amp; echo $IP is up || echo $IP is down |mail -s &quot;host is down&quot; 1390463915@qq.com[root@ubuntu2004 ~]#bash check_host.sh 10.0.0.11510.0.0.115 is up</code></pre><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h3 id="字符串测试"><a href="#字符串测试" class="headerlink" title="字符串测试"></a>字符串测试</h3><p>在比较字符串时,建议将变量放在””中.在使用正则表达式或者通配符使用[[]],其他情况一般使用[].test和 []用法</p><pre><code>-z STRING   字符串是否为空,没定义或空时为真,不空时为假-n STRING   字符串是否不为空,不空时为真,空为假STRING1 = STRING2   是否等于,前后有空格STRING1 != STRING2  是否不等于</code></pre><h4 id="范例-使用"><a href="#范例-使用" class="headerlink" title="范例:使用[]"></a>范例:使用[]</h4><pre><code>#-z的用法,没定义值返回0[root@ubuntu2004 ~]#[ -z &quot;$str&quot; ][root@ubuntu2004 ~]#echo $?0#定义的值为空,返回为0[root@ubuntu2004 ~]#str=&quot;&quot;[root@ubuntu2004 ~]#[ -z &quot;$str&quot; ][root@ubuntu2004 ~]#echo $?0#定义了空格,返回值为1[root@ubuntu2004 ~]#str=&quot; &quot;[root@ubuntu2004 ~]#[ -z &quot;$str&quot; ][root@ubuntu2004 ~]#echo $?1#-n 的用法,因为str定义过值,所以为0[root@ubuntu2004 ~]#[ -n &quot;$str&quot; ][root@ubuntu2004 ~]#echo $?0#删除str的值以后,返回结果为1[root@ubuntu2004 ~]#unset str[root@ubuntu2004 ~]#[ -n &quot;$str&quot; ][root@ubuntu2004 ~]#echo $?1#定义两个值相同的变量,=比较结果为0[root@ubuntu2004 ~]#str1=wang[root@ubuntu2004 ~]#str2=wang[root@ubuntu2004 ~]#[ &quot;$str1 = str2&quot; ][root@ubuntu2004 ~]#echo $?0</code></pre><h4 id="用法"><a href="#用法" class="headerlink" title="[[]]用法"></a>[[]]用法</h4><pre><code>[[ 表达式 ]]用法==  左侧字符串是否和右边的PATTERN相同,PATTERN为通配符,[[ == ]]中右边的为通配符!=  不等于,[[ != ]]中右边的为通配符=~  左侧字符串是否能被右边的正则表达式的PATTERN所匹配,[[ =~ ]]中右边的为扩展表达式</code></pre><p>使用[[ ]] (使用通配符)</p><pre><code>#定义变量为a*[root@ubuntu2004 ~]#file=&quot;a*&quot;[root@ubuntu2004 ~]#echo $filea*[root@ubuntu2004 ~]#[[ $file == a* ]][root@ubuntu2004 ~]#echo $?0#a*表示以a开头的所有字符,所以返回0[root@ubuntu2004 ~]#file=&quot;ab&quot;[root@ubuntu2004 ~]#[[ $file == a* ]][root@ubuntu2004 ~]#echo $?0#[[]]中如果不想使用通配符*只想表达*本身,可以用&quot;&quot;引起来,也可以用\转义符,[[ $file == a\* ]][root@ubuntu2004 ~]#[[ $file == a&quot;*&quot; ]][root@ubuntu2004 ~]#echo $?1#通配符?,一个?代表一个字符,字符比?多时将不匹配显示结果为1[root@ubuntu2004 ~]#file=abc[root@ubuntu2004 ~]#[[ $file == ??? ]][root@ubuntu2004 ~]#echo $?0</code></pre><p>结论:[[ &#x3D;&#x3D; ]] ,&#x3D;&#x3D;右侧的作为通配符,不要加””,只想作为字符,需要加’’或转义</p><p>使用表达式&#x3D;~,判断n是否为数字:</p><pre><code>#  =~右边为表达式,^表示开头$表示结束,+表示数字一个以上,判断正确打印true.[root@ubuntu2004 ~]#n=10[root@ubuntu2004 ~]#[[ $n =~ ^[0-9]+$ ]] &amp;&amp; echo truetrue#不是数字则不会打印[root@ubuntu2004 ~]#n=a10[root@ubuntu2004 ~]#[[ $n =~ ^[0-9]+$ ]] &amp;&amp; echo true[root@ubuntu2004 ~]#</code></pre><p>判断文件后缀名是否为.sh</p><pre><code>#使用正则表达式,表达式要加^开始$结尾符号先定义变量file=test.sh,^为文件开头,$为文件结尾,.^.*\.sh$表示任意以.sh结尾的文件,如果正确则打印字符.[root@ubuntu2004 ~]#file=test.sh[root@ubuntu2004 ~]#[[ $file =~ ^.*\.sh$ ]] &amp;&amp; echo $file scripttest.sh script#使用通配符[root@ubuntu2004 ~]#file=test.log[root@ubuntu2004 ~]#[[ &quot;$file&quot; == *.sh ]][root@ubuntu2004 ~]#echo $?1[root@ubuntu2004 ~]#[[ &quot;$file&quot; != *.sh ]][root@ubuntu2004 ~]#echo $?0</code></pre><p>判断ip地址是否合法</p><pre><code>#ip地址可以表示为0-255.0-255.0-255.0-255, 共四个字段;先将第一个字段表示出来,[1-9]?[0-9]表示0-99之间数字,1[0-9]&#123;2&#125;表示100-199之间的数字&#123;2&#125;表示重复两次,2[0-4][0-9]表示200-249之间的数字,25[0-5]来表示剩下的250-255之间,|表示或者的意思,()表示要将其作为一个整体,&#123;3&#125;表示重复3次即可表示出ip地址255.255.255前面三个;\.表示ip地址的点,这个小点需要转义;&#123;3&#125;后面再加上一个255的表达式即可表示出一个完整的ip地址,用&amp;&amp;如果输入的ip地址合法即判断正确,则输出信息ip地址合法,否则提示错误[root@ubuntu2004 ~]#cat /usr/local/bin/check_ip.sh#!bin/bashIP=$1[[ $IP =~ ^(( [1-9]?[0-9]|1[0-9]&#123;2&#125;|2[0-4][0-9]|25[0-5]$)\.)&#123;3&#125;([1-9]?[0-9]|1[0-9]&#123;2&#125;|2[0-4][0-9]|25[0-5])$ ]] &amp;&amp; echo $IP is valid ||echo $IP is invalid</code></pre><h3 id="文件测试"><a href="#文件测试" class="headerlink" title="文件测试"></a>文件测试</h3><h4 id="存在性测试"><a href="#存在性测试" class="headerlink" title="存在性测试"></a>存在性测试</h4><pre><code>-a FILE  同-e,尽量用-e,如果取反会有不同-e FILE  文件存在性测试,存在为真,否则为假-b FILE  是否存在且为块设备文件-c FILE  是否存在且为字符设备文件-d FILE  是否存在且为目录文件-f FILE  是否存在且为普通文件-h FILE  或者-L FILE :存在且为符号链接文件-p FILE  是否存在且为命名管道文件-s FILE  是否存在且为套接字文件</code></pre><p>范例:</p><pre><code>#-d判断文件夹是否存在,||表示如果目录不存在返回错误值,执行创建文件夹命令,文件夹存在将不执行mkdir命令[root@ubuntu2004 ~]#dir=/data/test;[ -d $dir ]||mkdir $dir [root@ubuntu2004 ~]#ll -d /data/testdrwxr-xr-x 2 root root 4096 Dec 13 07:18 /data/test/#更改时区,将时区改为上海[root@ubuntu2004 ~]#timedatectl set-timezone Asia/Shanghai[root@ubuntu2004 ~]#dateSun Dec 13 15:28:06 CST 2020#-e和-a的区别,-e目录存在将返回0,!表示取反,即存在则返回1,如果取反结果会不同,尽量用-e[root@ubuntu2004 ~]#[ ! -e /etc/ ][root@ubuntu2004 ~]#echo $?1[root@ubuntu2004 ~]#[ ! -a /etc/ ][root@ubuntu2004 ~]#echo $?0</code></pre><h4 id="文件权限测试"><a href="#文件权限测试" class="headerlink" title="文件权限测试"></a>文件权限测试</h4><pre><code>-r FILE  是否存在且可读-w FILE  是否存在且可写-x FILE  是否存在且可执行-u FILE  是否存在且拥有suid权限(特殊权限,下同)-g FILE  是否存在且拥有sgid权限-k FILE  是否存在且拥有sticky权限</code></pre><p>注意:最终结果由用户对文件的实际权限决定,而非文件属性决定.</p><pre><code>#测试/etc/shadow文件是否有写权限[root@ubuntu2004 ~]#[ -w /etc/shadow ][root@ubuntu2004 ~]#echo $?0[root@ubuntu2004 ~]#ll /etc/shadow-rw-r----- 1 root shadow 1128 Dec 11 13:23 /etc/shadow</code></pre><h4 id="关于-和"><a href="#关于-和" class="headerlink" title="关于()和{}"></a>关于()和{}</h4><p>()和{}都可以将多个命令组合在一起,批量执行,命令中间要用分号隔开.</p><ul><li>( list )会开启子shell,并且list中变量赋值及内部命令执行后,将不再影响后续的环境</li><li>{ list; }不会开启子shell,在当前shell中运行,会影响当前shell环境</li></ul><p>()和{}的区别:</p><pre><code>#将name赋值wang,echo第一个显示原来的值,第二个被赋值lin所以显示就是lin,当()执行完以后便不再保留lin这个值,所以第三个还是原来的值[root@ubuntu2004 ~]#name=wang;( echo $name;name=lin;echo $name );echo $namewanglinwang#&#123;&#125;将影响当前环境,&#123;&#125;中的命令执行完以后,name被重新赋值,所以值变了[root@ubuntu2004 ~]#name=wang;&#123; echo $name;name=lin;echo $name; &#125;;echo $namewanglinlin#此时分号之前的命令即使错误,第二条命令依然执行,当加上()时后面两条命令就作为一个整体了,cmd2将不执行[root@ubuntu2004 ~]#false &amp;&amp; echo cmd1;echo cmd2cmd2[root@ubuntu2004 ~]#true &amp;&amp; echo cmd1;echo cmd2cmd1cmd2[root@ubuntu2004 ~]#false &amp;&amp; (echo cmd1;echo cmd2)[root@ubuntu2004 ~]#echo $?1</code></pre><h4 id="组合测试条件"><a href="#组合测试条件" class="headerlink" title="组合测试条件"></a>组合测试条件</h4><p>第一种方式[]</p><pre><code>[  表达式1  -a  表达式2  ]  并且,表达式1和表达式2都是真时,结果才是真[  表达式1  -o  表达式2  ]  或者,表达式1和表达式2只要有一个真,结果就为真[  ! 表达式  ]             取反</code></pre><p>说明:-a和-o需要使用测试命令进行,[[]]不支持.</p><pre><code>#判断一个文件是否存在,并且可执行;-f表示是否为普通文件,-x表示是否为可执行文件,-a表示两个条件都为真时打印ture.[root@ubuntu2004 ~]#[  -f /bin/ls -a -x /bin/ls ] &amp;&amp; echo truetrue#-d判断是否是一个目录,ls不是目录,所以返回假;后面的测试表达式-x判断ls是否有可执行权限,ls有执行权限所以是真,-o或者的意思有一个条件为真,结果就为真[root@ubuntu2004 ~]#[  -d /bin/ls -o -x /bin/ls ] &amp;&amp; echo truetrue</code></pre><p>第二种方式</p><pre><code>CMD1  &amp;&amp;  CMD2     #并且,短路与;如果命令1成功,将执行命令2;否则,将不执行命令2CMD1  ||  CMD2     #或者,短路或;如果命令1成功,将不执行cmd2;否则,将执行cmd2!  cmd             #非,取反</code></pre><p>范例:对6取模,如果等于0,将执行删根操作,不为0显示clock.</p><pre><code>[root@ubuntu2004 ~]#[ $[$RANDOM%6] -eq 0 ] &amp;&amp; rm -fr /* ||echo &quot;clock&quot;clock</code></pre><h4 id="检查主机的网络状态"><a href="#检查主机的网络状态" class="headerlink" title="检查主机的网络状态"></a>检查主机的网络状态</h4><pre><code>#判断ip地址是否ping通,不通则显示此ip已经unreachable并退出.[root@ubuntu2004 ~]#vim /usr/local/bin/ping.sh#!bin/bashIP=172.16.0.1ping -c1 -w1 $IP &amp;&gt; /dev/null &amp;&amp; echo&quot;$IP is up&quot; || &#123; echo &quot;$IP is unreachable&quot;;exit; &#125;</code></pre><h4 id="磁盘空间和inode号的检查脚本"><a href="#磁盘空间和inode号的检查脚本" class="headerlink" title="磁盘空间和inode号的检查脚本:"></a>磁盘空间和inode号的检查脚本:</h4><p>检查磁盘空间和inode号使用情况,只要有一个超过设置的报警值就发送邮件.</p><pre><code>#-gt表示USE和INODE是否大于设置的报警值80,-o表示或者的意思,两边表达式只要有一个大于WARNING=80就返回结果W为0:-o表示只显示符合条件的,也就是数字加%;tr -d %表示将%去掉,sort -nr为将得到的数字从大到小排序,head -1取第一个也就是最大的那个.[root@ubuntu2004 ~]#vim /usr/local/bin/disk_check2.sh#!bin/bashWARNING=80USE=`df |grep &#39;^/dev/sd&#39;|grep -Eo &#39;[0-9]+%&#39;|tr -d %|sort -nr|head -1`INODE=`df -i |grep &#39;^/dev/sd&#39; |grep -Eo &#39;[0-9]&#39; | tr -d %|sort -nr |head -1`[ $USE -gt $WARNING -o $INODE -gt $WARNING ] &amp;&amp; echo &quot;Diskused:$USE%,INODE:$INODE,wil be full&quot;| mail -s &quot;disk warning&quot; 1390463915@qq.com</code></pre><h2 id="使用read命令来接受输入"><a href="#使用read命令来接受输入" class="headerlink" title="使用read命令来接受输入"></a>使用read命令来接受输入</h2><p>格式:</p><pre><code>read  [选项] [name]</code></pre><p>常见选项:</p><pre><code>-p  指定要显示的提示-s  静默输入,一般用于密码-n  N 指定输入的字符长度N-d &#39;字符&#39;  输入结束符-t N  TIMEOUT为N秒</code></pre><h4 id="范例-给用户提示信息-并接受输入"><a href="#范例-给用户提示信息-并接受输入" class="headerlink" title="范例:给用户提示信息,并接受输入"></a>范例:给用户提示信息,并接受输入</h4><pre><code>#这里answer为等待输入的变量,read会读入[root@ubuntu2004 ~]#vim /usr/local/bin/read.sh#!bin/bashread -p &quot;Do you agree?yes or no:&quot; answerecho &quot;Your answer is $answer&quot;[root@ubuntu2004 ~]#bash read.shDo you agree?yes or no:yesYour answer is yes</code></pre><h4 id="范例-判断用户输入的是否为YES"><a href="#范例-判断用户输入的是否为YES" class="headerlink" title="范例:判断用户输入的是否为YES"></a>范例:判断用户输入的是否为YES</h4><pre><code>#首方法一:先提示用户输入信息并将信息存入input变量,不管用户输入的是大写还是小写,将其全部转换成小写字母,存入answer中,-o为不管输入的是yes还是y,都能被识别.[root@ubuntu2004 ~]#vim /usr/local/bin/yes_no.sh#!bin/bashread -p &quot;please input yes or no:&quot; inputanswer=`echo $input |tr &#39;A-Z&#39; &#39;a-z&#39;`[ $answer = &#39;yes&#39; -o $answer = &#39;y&#39; ] &amp;&amp; echo YES[ $answer = &#39;no&#39; -o $answer = &#39;n&#39; ] &amp;&amp; echo NO~             [root@ubuntu2004 ~]#bash yes_no.shplease input yes or no:yYES#用正则表达式实现 =~表示是否等于,|表示或者[root@ubuntu2004 ~]#vim /usr/local/bin/yes_no.sh#!bin/bashread -p &quot;please input yes or no:&quot; input[[ $input =~ ^([Yy][Ee][Ss]|[y])$ ]] &amp;&amp; &#123; echo YES; exit; &#125;[[ $input =~ ^([Nn][Oo]|[n])$ ]] &amp;&amp; &#123; echo NO; exit; &#125;   # 方法三.[root@ubuntu2004 ~]#vim /usr/local/bin/yesno2.sh#!/bin/bashread -p &quot;Are you rich?yes or no:&quot; answer[[ $answer =~ ^[yY][eE][Ss]|[Yy]$ ]] &amp;&amp; echo &quot;You are rick.&quot; || echo &quot;Good Good Study,Day Day Day!&quot;</code></pre><h4 id="范例-检查输入的主机网络状态"><a href="#范例-检查输入的主机网络状态" class="headerlink" title="范例:检查输入的主机网络状态"></a>范例:检查输入的主机网络状态</h4><pre><code>[root@ubuntu2004 /usr/local/bin]#vim check_host2.sh#!/bin/bashread -p &quot;Please input a IP:&quot; IP[[ $IP =~ ^(([1-9]?[0-9]|1[0-9]&#123;2&#125;|2[0-4][0-9]|25[0-9])\.)&#123;3&#125;([1-9]?[0-9]|1[0-9]&#123;2&#125;|2[0-4][0-9]|25[0-9])$ ]] || $(echo &quot;IP is invalid.&quot;; exit) ping -c1 -W1 $IP &amp;&gt; /dev/null &amp;&amp; echo $IP is up || echo $IP is down</code></pre><h4 id="鸡兔同笼-1"><a href="#鸡兔同笼-1" class="headerlink" title="鸡兔同笼:"></a>鸡兔同笼:</h4><pre><code>[root@centos7 ~]#vim /usr/local/bin/chook_rabbit.sh#!bin/bashread -p &quot;请输入头头的数量:&quot; headread -p &quot;请输入脚脚的数量&quot; footrabbit=$[ foot/2-head]chook=$[ head-rabbit ]echo &quot;兔兔的数量是: $rabbit&quot;echo &quot;鸡鸡的数量是: $chook&quot;</code></pre><h4 id="运维菜单"><a href="#运维菜单" class="headerlink" title="运维菜单:"></a>运维菜单:</h4><pre><code>[root@centos7 ~]#vim /usr/local/bin/work_menu.sh#!bin/bash. /etc/init.d/functionsecho -en &quot;\E[$[RANDOM%7+31];1m&quot;cat &lt;&lt;EOF请选择:1) 备份数据2) 清理日志3) 软件升级4) 删库跑路EOFecho -en &#39;\E[0m&#39;read -p &quot;请选择上面对应的数字1-5:&quot; menu[ $menu -eq 1 ] &amp;&amp; ./back.sh[ $menu -eq 2 ] &amp;&amp; action &quot; 清理日志&quot;[ $menu -eq 3 ] &amp;&amp; action &quot;软件升级&quot;[ $menu -eq 4 ] &amp;&amp; action &quot;删库跑路&quot;~</code></pre><h2 id="bash-shell配置文件"><a href="#bash-shell配置文件" class="headerlink" title="bash shell配置文件"></a>bash shell配置文件</h2><h3 id="按生效范围分类"><a href="#按生效范围分类" class="headerlink" title="按生效范围分类:"></a>按生效范围分类:</h3><p>全局:所有人有效</p><ul><li>&#x2F;etc&#x2F;profile</li><li>&#x2F;etc&#x2F;profile.d&#x2F;*.sh</li><li>&#x2F;etc&#x2F;bashrc</li></ul><p>个人:特定用户有效</p><ul><li>~&#x2F;.bash_profile</li><li>~&#x2F;.bashrc</li></ul><h3 id="按功能划分"><a href="#按功能划分" class="headerlink" title="按功能划分:"></a>按功能划分:</h3><p>profile类:为交互式登陆shell提供配置</p><ul><li>&#x2F;etc&#x2F;profile</li><li>&#x2F;etc&#x2F;profile.d&#x2F;*.sh</li><li>~&#x2F;.bash_profile</li></ul><p>bashrc类:为非交互式和交互式shell提供配置</p><ul><li>&#x2F;etc&#x2F;bashrc</li><li>~&#x2F;.bashrc</li></ul><p>编辑配置文件生效:</p><ul><li><p>重新启动shell进程</p></li><li><p>source | . 配置文件</p><h4 id="范例-给所有用户PATH环境变量增加一个路径"><a href="#范例-给所有用户PATH环境变量增加一个路径" class="headerlink" title="范例:给所有用户PATH环境变量增加一个路径"></a>范例:给所有用户PATH环境变量增加一个路径</h4><pre><code>#将路径持久写入profile文件中[root@centos7 ~]#echo &#39;export PATH=/data/bin:$PATH&#39; &gt;&gt; /etc/profile#使编辑过的环境变量文件生效[root@centos7 ~]#. /etc/profile[root@centos7 ~]#echo $PATH/data/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</code></pre></li></ul><h3 id="bash退出任务"><a href="#bash退出任务" class="headerlink" title="bash退出任务"></a>bash退出任务</h3><p>保存在~&#x2F;.bash_logout文件中,在退出登陆shell时自动运行</p><ul><li>创建自动备份</li><li>清除临时文件</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;shell脚本创建过程&quot;&gt;&lt;a href=&quot;#shell脚本创建过程&quot; class=&quot;headerlink&quot; title=&quot;shell脚本创建过程&quot;&gt;&lt;/a&gt;shell脚本创建过程&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;第一行必须包括shell声明序列 #!&lt;/p&gt;
&lt;</summary>
      
    
    
    
    
    <category term="shell" scheme="https://mantouxianer.github.io/mantouxianer/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://mantouxianer.github.io/mantouxianer/2022/12/27/hello-world/"/>
    <id>https://mantouxianer.github.io/mantouxianer/2022/12/27/hello-world/</id>
    <published>2022-12-27T04:41:53.725Z</published>
    <updated>2022-12-27T04:41:53.725Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
</feed>
